<div class="container mt-4">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <!-- Unified Card -->
      <div class="card">
        <!-- Card Header with Task Title and Author -->
        <div class="card-header">
          <h4 class="mb-1"><%= @task.title %></h4>
        </div>

        <!-- Card Body for Task Details -->
        <div class="card-body">
          <p><strong>Description:</strong> <%= @task.description.presence || "No description provided." %></p>
          <p><strong>Deadline:</strong> <%= @task.deadline&.strftime('%B %d, %Y %I:%M %p') || "No deadline set." %></p>
          <p><strong>Status:</strong> <%= @task.completed? ? "Completed" : "Pending" %></p>
        </div>
        <div class="card-footer d-flex justify-content-between">
          <%= link_to 'Back to Tasks', tasks_path, class: 'btn btn-secondary btn-sm' %>
          <a href="<%= edit_task_path(@task) %>" class="btn btn-primary btn-sm">Edit</a>
          <%= button_to 'Delete', task_path(@task), method: :delete, data: { confirm: 'Are you sure you want to delete this task?' }, class: 'btn btn-danger btn-sm' %>
        </div>

        <!-- Divider -->
        <hr class="m-0">

        <!-- Comments Section -->
        <div class="card-body">
          <h5>Comments</h5>
          <% if @task.comments.any? %>
            <% @task.comments.each do |comment| %>
              <div class="mb-3">
                <strong><%= comment.user.email %>:</strong>
                <p class="mb-1"><%= comment.content %></p>
                <small class="text-muted"><%= comment.created_at.strftime('%B %d, %Y %I:%M %p') %></small>
                <hr>
              </div>
            <% end %>
          <% else %>
            <p class="text-muted">No comments yet. Be the first to comment!</p>
          <% end %>
        </div>

        <!-- Add Comment Form -->
        <div class="card-body bg-light">
          <h5>Add a Comment</h5>
          <%= form_with model: [@task, Comment.new], local: true do |form| %>
            <div class="mb-3">
              <%= form.text_area :content, class: "form-control", placeholder: "Write your comment here..." %>
            </div>
            <%= form.submit "Add Comment", class: "btn btn-primary" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
